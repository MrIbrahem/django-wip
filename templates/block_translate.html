{% extends "wip_base.html" %}
{% load staticfiles i18n %}

{% block extra_head %}
<style>
    label { display: inline; font-weight: bold; margin-right: 1.0em; padding: 0.2em 0em; }
    pre { display: inline;  padding: 0; }
    pre code { display: inline; }
</style>
{% endblock %}

{% block head_title %}Block: {{ site.name }}{{ page_block.xpath }}{% endblock %}

{% block title-page %}<span style="color: black; font-size: smaller;">Translate block:</span> <span style="font-size: small;">{{ page_block.xpath }}</span>{% endblock %}

{% block content-page %}
<form action="/block/{{ page_block.id }}/translate/" method="post">
	{% csrf_token %}
    <div><label>Site</label> <a href="/site/{{ site.slug }}/">{{ site.name }}</a></div>
    <div><label>Site language</label> {{ site.language }}
    <div><label>Block id</label> {{ page_block.id }}</div>
    <div><label>Time</label> {{ page_block.time|date:"SHORT_DATETIME_FORMAT" }}</div>
    <fieldset style="border: 1px;">
    <div><label>Block language</label> {{ form.language }} &nbsp;
    	 <label>No-translate</label> {{ form.no_translate }} &nbsp;&nbsp;
	     <input type="submit" name="save_block" value="Save properties" class="btn btn-sm" /></div>
	</fieldset>
    <div>
		<a class="btn btn-sm" href="/block/{{ page_block.id }}/">View</a>
		{% if previous %}<input type="submit" name="prev" class="btn btn-sm" value="Previous">{% endif %}
		{% if next %}<input type="submit" name="next" class="btn btn-sm" value="Next">{% endif %}
	</div>
	<div>
		&nbsp;&nbsp; Skip translated {{ form.skip_translated }}
		&nbsp;&nbsp; Skip no-translate {{ form.skip_no_translate }}
		&nbsp;&nbsp; Exclude {{ form.exclude_language }}
		&nbsp;&nbsp; Include {{ form.include_language }}
	</div>

	<table style="border-collapse: separate; border-spacing: 5px;">
	<thead>
	<tr><th width="6%">language</th><th width="50%">block</th><th width="44%" colspan="2">segments and strings</th></tr>
	</thead>
	<tbody>
	<tr style="vertical-align: top;"><td>Source</td><td><pre>{{ page_block.body }}</pre></td>
	<td style="vertical-align: top;">{% for segment, strings in source_segments %}
		<div style="padding-left: 1.8em; text-indent: -1.8em;"><code>{{forloop.counter|rjust:"3"}}</code> <span style=""><span>{{ segment }}</span></div>
		{% for string in strings %}
		<div style="font-style: italic; font-size: small; padding-left: 1.8em;">{{ string }}</div>
		{% endfor %}
	{% endfor %}</td>
	</tr>
	{% if not page_block.no_translate %}
	{% for language, block, segment_strings in target_list %}
	<tr style="vertical-align: top;"><td>{{ language.name }}</td>
	<td>
	{% if blocks %}
	<textarea name="translation-{{ language.code }}" style="width: 96%; height:100px; margin-top: 0.5em;">{{ block.body }}</textarea>
	<input type="submit" value="Modify translation" name="modify-{{ language.code }}" />
	{% else %}
	<textarea name="translation-{{ language.code }}"  style="width: 96%; height:100px;">{{ page_block.body }}</textarea>
	<input type="submit" class="btn btn-sm" value="Create translation" name="create-{{ language.code }}" />
	{% endif %}
	</td>
	<td style="vertical-align: top;">{% for strings in segment_strings %}
		{% if strings %}<div><code>{{forloop.counter|rjust:"3"}}</code></div>
		{% for string in strings %}<div style="font-style: italic; font-size: small; padding-left: 1.8em;">{{ string }}</div>{% endfor %}
		{% endif %}
	{% endfor %}</td>
	</tr>
	{% endfor %}
	{% endif %}
	</tbody>
	</table>
</form>
{% endblock %}
